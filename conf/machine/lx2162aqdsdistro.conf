MACHINE="lx2162aqds"
require conf/machine/lx2162aqds.conf

require conf/machine/include/ubuntubasics.inc

require conf/machine/include/layerscape-composite-memory-map.inc
HOSTTOOLS_NONFATAL:append = " bc"
BOOT_TYPE = "sd xspi emmc"
BOOTLOADER_TYPE = "uboot"

export COMPOSITE_IMG1_FILE_sd       = "atf/bl2_sd.pbl"
export COMPOSITE_IMG1_FILE_sd_sec   = "atf/bl2_sd_sec.pbl"
export COMPOSITE_IMG1_FILE_xspi     = "atf/bl2_flexspi_nor.pbl"
export COMPOSITE_IMG1_FILE_xspi_sec = "atf/bl2_flexspi_nor_sec.pbl"
export COMPOSITE_IMG1_FILE_emmc     =  "atf/bl2_emmc.pbl"
export COMPOSITE_IMG2_FILE          = "atf/fip_uboot.bin"
export COMPOSITE_IMG2_FILE_sec      = "atf/fip_uboot_sec.bin"
export COMPOSITE_IMG4_FILE_sd_sec   = "secboot_hdrs/secboot_hdrs_sdboot.bin"
export COMPOSITE_IMG4_FILE_xspi_sec = "secboot_hdrs/secboot_hdrs_xspiboot.bin"
export COMPOSITE_IMG5_FILE          = "ddr-phy/fip_ddr_all.bin"
export COMPOSITE_IMG5_FILE_sec      = "atf/ddr_fip_sec.bin"
export COMPOSITE_IMG9_FILE          = "inphi/in112525-phy-ucode.txt"
export COMPOSITE_IMG11_FILE         = "mc_app/mc.itb"
export COMPOSITE_IMG12_FILE         = "mc-utils/dpl-18_5-17_2.dtb"
export COMPOSITE_IMG13_FILE         = "mc-utils/dpc_17_2.dtb"
export COMPOSITE_IMG14_FILE         = "fsl-lx2162a-qds.dtb"

distro_boot_script ?= "\
  env exists dtb || setenv dtb fsl-lx2162a-qds.dtb; \
  env exists kernel_image || setenv kernel_image Image; \
  env exists devpart_boot || setenv devpart_boot 1; \
  env exists devpart_root || setenv devpart_root 4; \
  part uuid \$devtype \$devnum:\$devpart_root partuuidr; \
  setenv bootargs console=ttyS0,115200 earlycon=uart8250,mmio,0x21c0500 root=PARTUUID=\$partuuidr rw rootwait \$othbootargs; \
  load \$devtype \$devnum:\$devpart_root \$kernel_addr_r boot/\$kernel_image; \
  load \$devtype \$devnum:\$devpart_root \$fdt_addr_r boot/\$dtb; \
  env exists secureboot && echo validating secureboot && run secureboot_validate; \
  booti \$kernel_addr_r - \$fdt_addr_r"
